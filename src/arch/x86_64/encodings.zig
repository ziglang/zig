const Encoding = @import("Encoding.zig");
const Mnemonic = Encoding.Mnemonic;
const OpEn = Encoding.OpEn;
const Op = Encoding.Op;
const Mode = Encoding.Mode;

const modrm_ext = u3;

const Entry = struct { Mnemonic, OpEn, Op, Op, Op, Op, []const u8, modrm_ext, Mode };

// TODO move this into a .zon file when Zig is capable of importing .zon files
// zig fmt: off
pub const table = &[_]Entry{
    // General-purpose
    .{ .adc, .zi, .al,   .imm8,   .none, .none, &.{ 0x14 }, 0, .none  },
    .{ .adc, .zi, .ax,   .imm16,  .none, .none, &.{ 0x15 }, 0, .none  },
    .{ .adc, .zi, .eax,  .imm32,  .none, .none, &.{ 0x15 }, 0, .none  },
    .{ .adc, .zi, .rax,  .imm32s, .none, .none, &.{ 0x15 }, 0, .long  },
    .{ .adc, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 2, .none  },
    .{ .adc, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 2, .rex   },
    .{ .adc, .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 2, .none  },
    .{ .adc, .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 2, .none  },
    .{ .adc, .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 2, .long  },
    .{ .adc, .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 2, .none  },
    .{ .adc, .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 2, .none  },
    .{ .adc, .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 2, .long  },
    .{ .adc, .mr, .rm8,  .r8,     .none, .none, &.{ 0x10 }, 0, .none  },
    .{ .adc, .mr, .rm8,  .r8,     .none, .none, &.{ 0x10 }, 0, .rex   },
    .{ .adc, .mr, .rm16, .r16,    .none, .none, &.{ 0x11 }, 0, .none  },
    .{ .adc, .mr, .rm32, .r32,    .none, .none, &.{ 0x11 }, 0, .none  },
    .{ .adc, .mr, .rm64, .r64,    .none, .none, &.{ 0x11 }, 0, .long  },
    .{ .adc, .rm, .r8,   .rm8,    .none, .none, &.{ 0x12 }, 0, .none  },
    .{ .adc, .rm, .r8,   .rm8,    .none, .none, &.{ 0x12 }, 0, .rex   },
    .{ .adc, .rm, .r16,  .rm16,   .none, .none, &.{ 0x13 }, 0, .none  },
    .{ .adc, .rm, .r32,  .rm32,   .none, .none, &.{ 0x13 }, 0, .none  },
    .{ .adc, .rm, .r64,  .rm64,   .none, .none, &.{ 0x13 }, 0, .long  },

    .{ .add, .zi, .al,   .imm8,   .none, .none, &.{ 0x04 }, 0, .none  },
    .{ .add, .zi, .ax,   .imm16,  .none, .none, &.{ 0x05 }, 0, .none  },
    .{ .add, .zi, .eax,  .imm32,  .none, .none, &.{ 0x05 }, 0, .none  },
    .{ .add, .zi, .rax,  .imm32s, .none, .none, &.{ 0x05 }, 0, .long  },
    .{ .add, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 0, .none  },
    .{ .add, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 0, .rex   },
    .{ .add, .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 0, .none  },
    .{ .add, .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 0, .none  },
    .{ .add, .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 0, .long  },
    .{ .add, .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 0, .none  },
    .{ .add, .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 0, .none  },
    .{ .add, .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 0, .long  },
    .{ .add, .mr, .rm8,  .r8,     .none, .none, &.{ 0x00 }, 0, .none  },
    .{ .add, .mr, .rm8,  .r8,     .none, .none, &.{ 0x00 }, 0, .rex   },
    .{ .add, .mr, .rm16, .r16,    .none, .none, &.{ 0x01 }, 0, .none  },
    .{ .add, .mr, .rm32, .r32,    .none, .none, &.{ 0x01 }, 0, .none  },
    .{ .add, .mr, .rm64, .r64,    .none, .none, &.{ 0x01 }, 0, .long  },
    .{ .add, .rm, .r8,   .rm8,    .none, .none, &.{ 0x02 }, 0, .none  },
    .{ .add, .rm, .r8,   .rm8,    .none, .none, &.{ 0x02 }, 0, .rex   },
    .{ .add, .rm, .r16,  .rm16,   .none, .none, &.{ 0x03 }, 0, .none  },
    .{ .add, .rm, .r32,  .rm32,   .none, .none, &.{ 0x03 }, 0, .none  },
    .{ .add, .rm, .r64,  .rm64,   .none, .none, &.{ 0x03 }, 0, .long  },

    .{ .@"and", .zi, .al,   .imm8,   .none, .none, &.{ 0x24 }, 0, .none  },
    .{ .@"and", .zi, .ax,   .imm16,  .none, .none, &.{ 0x25 }, 0, .none  },
    .{ .@"and", .zi, .eax,  .imm32,  .none, .none, &.{ 0x25 }, 0, .none  },
    .{ .@"and", .zi, .rax,  .imm32s, .none, .none, &.{ 0x25 }, 0, .long  },
    .{ .@"and", .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 4, .none  },
    .{ .@"and", .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 4, .rex   },
    .{ .@"and", .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 4, .none  },
    .{ .@"and", .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 4, .none  },
    .{ .@"and", .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 4, .long  },
    .{ .@"and", .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 4, .none  },
    .{ .@"and", .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 4, .none  },
    .{ .@"and", .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 4, .long  },
    .{ .@"and", .mr, .rm8,  .r8,     .none, .none, &.{ 0x20 }, 0, .none  },
    .{ .@"and", .mr, .rm8,  .r8,     .none, .none, &.{ 0x20 }, 0, .rex   },
    .{ .@"and", .mr, .rm16, .r16,    .none, .none, &.{ 0x21 }, 0, .none  },
    .{ .@"and", .mr, .rm32, .r32,    .none, .none, &.{ 0x21 }, 0, .none  },
    .{ .@"and", .mr, .rm64, .r64,    .none, .none, &.{ 0x21 }, 0, .long  },
    .{ .@"and", .rm, .r8,   .rm8,    .none, .none, &.{ 0x22 }, 0, .none  },
    .{ .@"and", .rm, .r8,   .rm8,    .none, .none, &.{ 0x22 }, 0, .rex   },
    .{ .@"and", .rm, .r16,  .rm16,   .none, .none, &.{ 0x23 }, 0, .none  },
    .{ .@"and", .rm, .r32,  .rm32,   .none, .none, &.{ 0x23 }, 0, .none  },
    .{ .@"and", .rm, .r64,  .rm64,   .none, .none, &.{ 0x23 }, 0, .long  },

    .{ .bsf, .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0xbc }, 0, .none },
    .{ .bsf, .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0xbc }, 0, .none },
    .{ .bsf, .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0xbc }, 0, .long },

    .{ .bsr, .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0xbd }, 0, .none },
    .{ .bsr, .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0xbd }, 0, .none },
    .{ .bsr, .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0xbd }, 0, .long },

    .{ .bswap, .o, .r32, .none, .none, .none, &.{ 0x0f, 0xc8 }, 0, .none },
    .{ .bswap, .o, .r64, .none, .none, .none, &.{ 0x0f, 0xc8 }, 0, .long },

    .{ .bt, .mr, .rm16, .r16,  .none, .none, &.{ 0x0f, 0xa3 }, 0, .none },
    .{ .bt, .mr, .rm32, .r32,  .none, .none, &.{ 0x0f, 0xa3 }, 0, .none },
    .{ .bt, .mr, .rm64, .r64,  .none, .none, &.{ 0x0f, 0xa3 }, 0, .long },
    .{ .bt, .mi, .rm16, .imm8, .none, .none, &.{ 0x0f, 0xba }, 4, .none },
    .{ .bt, .mi, .rm32, .imm8, .none, .none, &.{ 0x0f, 0xba }, 4, .none },
    .{ .bt, .mi, .rm64, .imm8, .none, .none, &.{ 0x0f, 0xba }, 4, .long },

    .{ .btc, .mr, .rm16, .r16,  .none, .none, &.{ 0x0f, 0xbb }, 0, .none },
    .{ .btc, .mr, .rm32, .r32,  .none, .none, &.{ 0x0f, 0xbb }, 0, .none },
    .{ .btc, .mr, .rm64, .r64,  .none, .none, &.{ 0x0f, 0xbb }, 0, .long },
    .{ .btc, .mi, .rm16, .imm8, .none, .none, &.{ 0x0f, 0xba }, 7, .none },
    .{ .btc, .mi, .rm32, .imm8, .none, .none, &.{ 0x0f, 0xba }, 7, .none },
    .{ .btc, .mi, .rm64, .imm8, .none, .none, &.{ 0x0f, 0xba }, 7, .long },

    .{ .btr, .mr, .rm16, .r16,  .none, .none, &.{ 0x0f, 0xb3 }, 0, .none },
    .{ .btr, .mr, .rm32, .r32,  .none, .none, &.{ 0x0f, 0xb3 }, 0, .none },
    .{ .btr, .mr, .rm64, .r64,  .none, .none, &.{ 0x0f, 0xb3 }, 0, .long },
    .{ .btr, .mi, .rm16, .imm8, .none, .none, &.{ 0x0f, 0xba }, 6, .none },
    .{ .btr, .mi, .rm32, .imm8, .none, .none, &.{ 0x0f, 0xba }, 6, .none },
    .{ .btr, .mi, .rm64, .imm8, .none, .none, &.{ 0x0f, 0xba }, 6, .long },

    .{ .bts, .mr, .rm16, .r16,  .none, .none, &.{ 0x0f, 0xab }, 0, .none },
    .{ .bts, .mr, .rm32, .r32,  .none, .none, &.{ 0x0f, 0xab }, 0, .none },
    .{ .bts, .mr, .rm64, .r64,  .none, .none, &.{ 0x0f, 0xab }, 0, .long },
    .{ .bts, .mi, .rm16, .imm8, .none, .none, &.{ 0x0f, 0xba }, 5, .none },
    .{ .bts, .mi, .rm32, .imm8, .none, .none, &.{ 0x0f, 0xba }, 5, .none },
    .{ .bts, .mi, .rm64, .imm8, .none, .none, &.{ 0x0f, 0xba }, 5, .long },

    // This is M encoding according to Intel, but D makes more sense here.
    .{ .call, .d, .rel32, .none, .none, .none, &.{ 0xe8 }, 0, .none },
    .{ .call, .m, .rm64,  .none, .none, .none, &.{ 0xff }, 2, .none },

    .{ .cbw,  .np, .o16, .none, .none, .none, &.{ 0x98 }, 0, .none  },
    .{ .cwde, .np, .o32, .none, .none, .none, &.{ 0x98 }, 0, .none  },
    .{ .cdqe, .np, .o64, .none, .none, .none, &.{ 0x98 }, 0, .long  },

    .{ .cwd, .np, .o16, .none, .none, .none, &.{ 0x99 }, 0, .none  },
    .{ .cdq, .np, .o32, .none, .none, .none, &.{ 0x99 }, 0, .none  },
    .{ .cqo, .np, .o64, .none, .none, .none, &.{ 0x99 }, 0, .long  },

    .{ .cmova,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x47 }, 0, .none  },
    .{ .cmova,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x47 }, 0, .none  },
    .{ .cmova,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x47 }, 0, .long  },
    .{ .cmovae,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x43 }, 0, .none  },
    .{ .cmovae,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x43 }, 0, .none  },
    .{ .cmovae,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x43 }, 0, .long  },
    .{ .cmovb,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x42 }, 0, .none  },
    .{ .cmovb,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x42 }, 0, .none  },
    .{ .cmovb,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x42 }, 0, .long  },
    .{ .cmovbe,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x46 }, 0, .none  },
    .{ .cmovbe,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x46 }, 0, .none  },
    .{ .cmovbe,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x46 }, 0, .long  },
    .{ .cmovc,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x42 }, 0, .none  },
    .{ .cmovc,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x42 }, 0, .none  },
    .{ .cmovc,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x42 }, 0, .long  },
    .{ .cmove,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x44 }, 0, .none  },
    .{ .cmove,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x44 }, 0, .none  },
    .{ .cmove,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x44 }, 0, .long  },
    .{ .cmovg,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4f }, 0, .none  },
    .{ .cmovg,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4f }, 0, .none  },
    .{ .cmovg,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4f }, 0, .long  },
    .{ .cmovge,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4d }, 0, .none  },
    .{ .cmovge,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4d }, 0, .none  },
    .{ .cmovge,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4d }, 0, .long  },
    .{ .cmovl,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4c }, 0, .none  },
    .{ .cmovl,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4c }, 0, .none  },
    .{ .cmovl,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4c }, 0, .long  },
    .{ .cmovle,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4e }, 0, .none  },
    .{ .cmovle,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4e }, 0, .none  },
    .{ .cmovle,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4e }, 0, .long  },
    .{ .cmovna,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x46 }, 0, .none  },
    .{ .cmovna,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x46 }, 0, .none  },
    .{ .cmovna,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x46 }, 0, .long  },
    .{ .cmovnae, .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x42 }, 0, .none  },
    .{ .cmovnae, .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x42 }, 0, .none  },
    .{ .cmovnae, .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x42 }, 0, .long  },
    .{ .cmovnb,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x43 }, 0, .none  },
    .{ .cmovnb,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x43 }, 0, .none  },
    .{ .cmovnb,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x43 }, 0, .long  },
    .{ .cmovnbe, .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x47 }, 0, .none  },
    .{ .cmovnbe, .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x47 }, 0, .none  },
    .{ .cmovnbe, .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x47 }, 0, .long  },
    .{ .cmovnc,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x43 }, 0, .none  },
    .{ .cmovnc,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x43 }, 0, .none  },
    .{ .cmovnc,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x43 }, 0, .long  },
    .{ .cmovne,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x45 }, 0, .none  },
    .{ .cmovne,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x45 }, 0, .none  },
    .{ .cmovne,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x45 }, 0, .long  },
    .{ .cmovng,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4e }, 0, .none  },
    .{ .cmovng,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4e }, 0, .none  },
    .{ .cmovng,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4e }, 0, .long  },
    .{ .cmovnge, .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4c }, 0, .none  },
    .{ .cmovnge, .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4c }, 0, .none  },
    .{ .cmovnge, .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4c }, 0, .long  },
    .{ .cmovnl,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4d }, 0, .none  },
    .{ .cmovnl,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4d }, 0, .none  },
    .{ .cmovnl,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4d }, 0, .long  },
    .{ .cmovnle, .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4f }, 0, .none  },
    .{ .cmovnle, .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4f }, 0, .none  },
    .{ .cmovnle, .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4f }, 0, .long  },
    .{ .cmovno,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x41 }, 0, .none  },
    .{ .cmovno,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x41 }, 0, .none  },
    .{ .cmovno,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x41 }, 0, .long  },
    .{ .cmovnp,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4b }, 0, .none  },
    .{ .cmovnp,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4b }, 0, .none  },
    .{ .cmovnp,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4b }, 0, .long  },
    .{ .cmovns,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x49 }, 0, .none  },
    .{ .cmovns,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x49 }, 0, .none  },
    .{ .cmovns,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x49 }, 0, .long  },
    .{ .cmovnz,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x45 }, 0, .none  },
    .{ .cmovnz,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x45 }, 0, .none  },
    .{ .cmovnz,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x45 }, 0, .long  },
    .{ .cmovo,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x40 }, 0, .none  },
    .{ .cmovo,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x40 }, 0, .none  },
    .{ .cmovo,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x40 }, 0, .long  },
    .{ .cmovp,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4a }, 0, .none  },
    .{ .cmovp,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4a }, 0, .none  },
    .{ .cmovp,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4a }, 0, .long  },
    .{ .cmovpe,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4a }, 0, .none  },
    .{ .cmovpe,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4a }, 0, .none  },
    .{ .cmovpe,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4a }, 0, .long  },
    .{ .cmovpo,  .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x4b }, 0, .none  },
    .{ .cmovpo,  .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x4b }, 0, .none  },
    .{ .cmovpo,  .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x4b }, 0, .long  },
    .{ .cmovs,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x48 }, 0, .none  },
    .{ .cmovs,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x48 }, 0, .none  },
    .{ .cmovs,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x48 }, 0, .long  },
    .{ .cmovz,   .rm, .r16, .rm16, .none, .none, &.{ 0x0f, 0x44 }, 0, .none  },
    .{ .cmovz,   .rm, .r32, .rm32, .none, .none, &.{ 0x0f, 0x44 }, 0, .none  },
    .{ .cmovz,   .rm, .r64, .rm64, .none, .none, &.{ 0x0f, 0x44 }, 0, .long  },

    .{ .cmp, .zi, .al,   .imm8,   .none, .none, &.{ 0x3c }, 0, .none  },
    .{ .cmp, .zi, .ax,   .imm16,  .none, .none, &.{ 0x3d }, 0, .none  },
    .{ .cmp, .zi, .eax,  .imm32,  .none, .none, &.{ 0x3d }, 0, .none  },
    .{ .cmp, .zi, .rax,  .imm32s, .none, .none, &.{ 0x3d }, 0, .long  },
    .{ .cmp, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 7, .none  },
    .{ .cmp, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 7, .rex   },
    .{ .cmp, .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 7, .none  },
    .{ .cmp, .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 7, .none  },
    .{ .cmp, .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 7, .long  },
    .{ .cmp, .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 7, .none  },
    .{ .cmp, .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 7, .none  },
    .{ .cmp, .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 7, .long  },
    .{ .cmp, .mr, .rm8,  .r8,     .none, .none, &.{ 0x38 }, 0, .none  },
    .{ .cmp, .mr, .rm8,  .r8,     .none, .none, &.{ 0x38 }, 0, .rex   },
    .{ .cmp, .mr, .rm16, .r16,    .none, .none, &.{ 0x39 }, 0, .none  },
    .{ .cmp, .mr, .rm32, .r32,    .none, .none, &.{ 0x39 }, 0, .none  },
    .{ .cmp, .mr, .rm64, .r64,    .none, .none, &.{ 0x39 }, 0, .long  },
    .{ .cmp, .rm, .r8,   .rm8,    .none, .none, &.{ 0x3a }, 0, .none  },
    .{ .cmp, .rm, .r8,   .rm8,    .none, .none, &.{ 0x3a }, 0, .rex   },
    .{ .cmp, .rm, .r16,  .rm16,   .none, .none, &.{ 0x3b }, 0, .none  },
    .{ .cmp, .rm, .r32,  .rm32,   .none, .none, &.{ 0x3b }, 0, .none  },
    .{ .cmp, .rm, .r64,  .rm64,   .none, .none, &.{ 0x3b }, 0, .long  },

    .{ .cmps,  .np, .m8,   .m8,   .none, .none, &.{ 0xa6 }, 0, .none  },
    .{ .cmps,  .np, .m16,  .m16,  .none, .none, &.{ 0xa7 }, 0, .none  },
    .{ .cmps,  .np, .m32,  .m32,  .none, .none, &.{ 0xa7 }, 0, .none  },
    .{ .cmps,  .np, .m64,  .m64,  .none, .none, &.{ 0xa7 }, 0, .long  },
    .{ .cmpsb, .np, .none, .none, .none, .none, &.{ 0xa6 }, 0, .none  },
    .{ .cmpsw, .np, .none, .none, .none, .none, &.{ 0xa7 }, 0, .short },
    .{ .cmpsd, .np, .none, .none, .none, .none, &.{ 0xa7 }, 0, .none  },
    .{ .cmpsq, .np, .none, .none, .none, .none, &.{ 0xa7 }, 0, .long  },

    .{ .cmpxchg, .mr, .rm8,  .r8,  .none, .none, &.{ 0x0f, 0xb0 }, 0, .none },
    .{ .cmpxchg, .mr, .rm8,  .r8,  .none, .none, &.{ 0x0f, 0xb0 }, 0, .rex  },
    .{ .cmpxchg, .mr, .rm16, .r16, .none, .none, &.{ 0x0f, 0xb1 }, 0, .rex  },
    .{ .cmpxchg, .mr, .rm32, .r32, .none, .none, &.{ 0x0f, 0xb1 }, 0, .rex  },
    .{ .cmpxchg, .mr, .rm64, .r64, .none, .none, &.{ 0x0f, 0xb1 }, 0, .long },

    .{ .cmpxchg8b , .m, .m64,  .none, .none, .none, &.{ 0x0f, 0xc7 }, 1, .none },
    .{ .cmpxchg16b, .m, .m128, .none, .none, .none, &.{ 0x0f, 0xc7 }, 1, .long },

    .{ .div, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 6, .none  },
    .{ .div, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 6, .rex   },
    .{ .div, .m, .rm16, .none, .none, .none, &.{ 0xf7 }, 6, .none  },
    .{ .div, .m, .rm32, .none, .none, .none, &.{ 0xf7 }, 6, .none  },
    .{ .div, .m, .rm64, .none, .none, .none, &.{ 0xf7 }, 6, .long  },

    .{ .fisttp, .m, .m16, .none, .none, .none, &.{ 0xdf }, 1, .fpu },
    .{ .fisttp, .m, .m32, .none, .none, .none, &.{ 0xdb }, 1, .fpu },
    .{ .fisttp, .m, .m64, .none, .none, .none, &.{ 0xdd }, 1, .fpu },

    .{ .fld, .m, .m32, .none, .none, .none, &.{ 0xd9 }, 0, .fpu },
    .{ .fld, .m, .m64, .none, .none, .none, &.{ 0xdd }, 0, .fpu },
    .{ .fld, .m, .m80, .none, .none, .none, &.{ 0xdb }, 5, .fpu },

    .{ .idiv, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 7, .none  },
    .{ .idiv, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 7, .rex   },
    .{ .idiv, .m, .rm16, .none, .none, .none, &.{ 0xf7 }, 7, .none  },
    .{ .idiv, .m, .rm32, .none, .none, .none, &.{ 0xf7 }, 7, .none  },
    .{ .idiv, .m, .rm64, .none, .none, .none, &.{ 0xf7 }, 7, .long  },

    .{ .imul, .m,   .rm8,  .none, .none,  .none, &.{ 0xf6       }, 5, .none  },
    .{ .imul, .m,   .rm8,  .none, .none,  .none, &.{ 0xf6       }, 5, .rex   },
    .{ .imul, .m,   .rm16, .none, .none,  .none, &.{ 0xf7       }, 5, .none  },
    .{ .imul, .m,   .rm32, .none, .none,  .none, &.{ 0xf7       }, 5, .none  },
    .{ .imul, .m,   .rm64, .none, .none,  .none, &.{ 0xf7       }, 5, .long  },
    .{ .imul, .rm,  .r16,  .rm16, .none,  .none, &.{ 0x0f, 0xaf }, 0, .none  },
    .{ .imul, .rm,  .r32,  .rm32, .none,  .none, &.{ 0x0f, 0xaf }, 0, .none  },
    .{ .imul, .rm,  .r64,  .rm64, .none,  .none, &.{ 0x0f, 0xaf }, 0, .long  },
    .{ .imul, .rmi, .r16,  .rm16, .imm8s, .none, &.{ 0x6b       }, 0, .none  },
    .{ .imul, .rmi, .r32,  .rm32, .imm8s, .none, &.{ 0x6b       }, 0, .none  },
    .{ .imul, .rmi, .r64,  .rm64, .imm8s, .none, &.{ 0x6b       }, 0, .long  },
    .{ .imul, .rmi, .r16,  .rm16, .imm16, .none, &.{ 0x69       }, 0, .none  },
    .{ .imul, .rmi, .r32,  .rm32, .imm32, .none, &.{ 0x69       }, 0, .none  },
    .{ .imul, .rmi, .r64,  .rm64, .imm32, .none, &.{ 0x69       }, 0, .long  },

    .{ .int3, .np, .none, .none, .none, .none, &.{ 0xcc }, 0, .none },

    .{ .ja,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x87 }, 0, .none },
    .{ .jae,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x83 }, 0, .none },
    .{ .jb,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x82 }, 0, .none },
    .{ .jbe,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x86 }, 0, .none },
    .{ .jc,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x82 }, 0, .none },
    .{ .jrcxz, .d, .rel32, .none, .none, .none, &.{ 0xe3       }, 0, .none },
    .{ .je,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x84 }, 0, .none },
    .{ .jg,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8f }, 0, .none },
    .{ .jge,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8d }, 0, .none },
    .{ .jl,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8c }, 0, .none },
    .{ .jle,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8e }, 0, .none },
    .{ .jna,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x86 }, 0, .none },
    .{ .jnae,  .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x82 }, 0, .none },
    .{ .jnb,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x83 }, 0, .none },
    .{ .jnbe,  .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x87 }, 0, .none },
    .{ .jnc,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x83 }, 0, .none },
    .{ .jne,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x85 }, 0, .none },
    .{ .jng,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8e }, 0, .none },
    .{ .jnge,  .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8c }, 0, .none },
    .{ .jnl,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8d }, 0, .none },
    .{ .jnle,  .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8f }, 0, .none },
    .{ .jno,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x81 }, 0, .none },
    .{ .jnp,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8b }, 0, .none },
    .{ .jns,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x89 }, 0, .none },
    .{ .jnz,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x85 }, 0, .none },
    .{ .jo,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x80 }, 0, .none },
    .{ .jp,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8a }, 0, .none },
    .{ .jpe,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8a }, 0, .none },
    .{ .jpo,   .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x8b }, 0, .none },
    .{ .js,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x88 }, 0, .none },
    .{ .jz,    .d, .rel32, .none, .none, .none, &.{ 0x0f, 0x84 }, 0, .none },

    .{ .jmp, .d, .rel32, .none, .none, .none, &.{ 0xe9 }, 0, .none },
    .{ .jmp, .m, .rm64,  .none, .none, .none, &.{ 0xff }, 4, .none },

    .{ .lea, .rm, .r16, .m, .none, .none, &.{ 0x8d }, 0, .none  },
    .{ .lea, .rm, .r32, .m, .none, .none, &.{ 0x8d }, 0, .none  },
    .{ .lea, .rm, .r64, .m, .none, .none, &.{ 0x8d }, 0, .long  },

    .{ .lfence, .np, .none, .none, .none, .none, &.{ 0x0f, 0xae, 0xe8 }, 0, .none },

    .{ .lods,  .np, .m8,   .none, .none, .none, &.{ 0xac }, 0, .none  },
    .{ .lods,  .np, .m16,  .none, .none, .none, &.{ 0xad }, 0, .none  },
    .{ .lods,  .np, .m32,  .none, .none, .none, &.{ 0xad }, 0, .none  },
    .{ .lods,  .np, .m64,  .none, .none, .none, &.{ 0xad }, 0, .long  },
    .{ .lodsb, .np, .none, .none, .none, .none, &.{ 0xac }, 0, .none  },
    .{ .lodsw, .np, .none, .none, .none, .none, &.{ 0xad }, 0, .short },
    .{ .lodsd, .np, .none, .none, .none, .none, &.{ 0xad }, 0, .none  },
    .{ .lodsq, .np, .none, .none, .none, .none, &.{ 0xad }, 0, .long  },

    .{ .lzcnt, .rm, .r16, .rm16, .none, .none, &.{ 0xf3, 0x0f, 0xbd }, 0, .none },
    .{ .lzcnt, .rm, .r32, .rm32, .none, .none, &.{ 0xf3, 0x0f, 0xbd }, 0, .none },
    .{ .lzcnt, .rm, .r64, .rm64, .none, .none, &.{ 0xf3, 0x0f, 0xbd }, 0, .long },

    .{ .mfence, .np, .none, .none, .none, .none, &.{ 0x0f, 0xae, 0xf0 }, 0, .none },

    .{ .mov, .mr, .rm8,   .r8,     .none, .none, &.{ 0x88 }, 0, .none  },
    .{ .mov, .mr, .rm8,   .r8,     .none, .none, &.{ 0x88 }, 0, .rex   },
    .{ .mov, .mr, .rm16,  .r16,    .none, .none, &.{ 0x89 }, 0, .none  },
    .{ .mov, .mr, .rm32,  .r32,    .none, .none, &.{ 0x89 }, 0, .none  },
    .{ .mov, .mr, .rm64,  .r64,    .none, .none, &.{ 0x89 }, 0, .long  },
    .{ .mov, .rm, .r8,    .rm8,    .none, .none, &.{ 0x8a }, 0, .none  },
    .{ .mov, .rm, .r8,    .rm8,    .none, .none, &.{ 0x8a }, 0, .rex   },
    .{ .mov, .rm, .r16,   .rm16,   .none, .none, &.{ 0x8b }, 0, .none  },
    .{ .mov, .rm, .r32,   .rm32,   .none, .none, &.{ 0x8b }, 0, .none  },
    .{ .mov, .rm, .r64,   .rm64,   .none, .none, &.{ 0x8b }, 0, .long  },
    .{ .mov, .mr, .rm16,  .sreg,   .none, .none, &.{ 0x8c }, 0, .none  },
    .{ .mov, .mr, .rm64,  .sreg,   .none, .none, &.{ 0x8c }, 0, .long  },
    .{ .mov, .rm, .sreg,  .rm16,   .none, .none, &.{ 0x8e }, 0, .none  },
    .{ .mov, .rm, .sreg,  .rm64,   .none, .none, &.{ 0x8e }, 0, .long  },
    .{ .mov, .fd, .al,    .moffs,  .none, .none, &.{ 0xa0 }, 0, .none  },
    .{ .mov, .fd, .ax,    .moffs,  .none, .none, &.{ 0xa1 }, 0, .none  },
    .{ .mov, .fd, .eax,   .moffs,  .none, .none, &.{ 0xa1 }, 0, .none  },
    .{ .mov, .fd, .rax,   .moffs,  .none, .none, &.{ 0xa1 }, 0, .long  },
    .{ .mov, .td, .moffs, .al,     .none, .none, &.{ 0xa2 }, 0, .none  },
    .{ .mov, .td, .moffs, .ax,     .none, .none, &.{ 0xa3 }, 0, .none  },
    .{ .mov, .td, .moffs, .eax,    .none, .none, &.{ 0xa3 }, 0, .none  },
    .{ .mov, .td, .moffs, .rax,    .none, .none, &.{ 0xa3 }, 0, .long  },
    .{ .mov, .oi, .r8,    .imm8,   .none, .none, &.{ 0xb0 }, 0, .none  },
    .{ .mov, .oi, .r8,    .imm8,   .none, .none, &.{ 0xb0 }, 0, .rex   },
    .{ .mov, .oi, .r16,   .imm16,  .none, .none, &.{ 0xb8 }, 0, .none  },
    .{ .mov, .oi, .r32,   .imm32,  .none, .none, &.{ 0xb8 }, 0, .none  },
    .{ .mov, .oi, .r64,   .imm64,  .none, .none, &.{ 0xb8 }, 0, .long  },
    .{ .mov, .mi, .rm8,   .imm8,   .none, .none, &.{ 0xc6 }, 0, .none  },
    .{ .mov, .mi, .rm8,   .imm8,   .none, .none, &.{ 0xc6 }, 0, .rex   },
    .{ .mov, .mi, .rm16,  .imm16,  .none, .none, &.{ 0xc7 }, 0, .none  },
    .{ .mov, .mi, .rm32,  .imm32,  .none, .none, &.{ 0xc7 }, 0, .none  },
    .{ .mov, .mi, .rm64,  .imm32s, .none, .none, &.{ 0xc7 }, 0, .long  },

    .{ .movbe, .rm, .r16, .m16, .none, .none, &.{ 0x0f, 0x38, 0xf0 }, 0, .none },
    .{ .movbe, .rm, .r32, .m32, .none, .none, &.{ 0x0f, 0x38, 0xf0 }, 0, .none },
    .{ .movbe, .rm, .r64, .m64, .none, .none, &.{ 0x0f, 0x38, 0xf0 }, 0, .long },
    .{ .movbe, .mr, .m16, .r16, .none, .none, &.{ 0x0f, 0x38, 0xf1 }, 0, .none },
    .{ .movbe, .mr, .m32, .r32, .none, .none, &.{ 0x0f, 0x38, 0xf1 }, 0, .none },
    .{ .movbe, .mr, .m64, .r64, .none, .none, &.{ 0x0f, 0x38, 0xf1 }, 0, .long },

    .{ .movs,  .np, .m8,   .m8,   .none, .none, &.{ 0xa4 }, 0, .none  },
    .{ .movs,  .np, .m16,  .m16,  .none, .none, &.{ 0xa5 }, 0, .none  },
    .{ .movs,  .np, .m32,  .m32,  .none, .none, &.{ 0xa5 }, 0, .none  },
    .{ .movs,  .np, .m64,  .m64,  .none, .none, &.{ 0xa5 }, 0, .long  },
    .{ .movsb, .np, .none, .none, .none, .none, &.{ 0xa4 }, 0, .none  },
    .{ .movsw, .np, .none, .none, .none, .none, &.{ 0xa5 }, 0, .short },
    .{ .movsd, .np, .none, .none, .none, .none, &.{ 0xa5 }, 0, .none  },
    .{ .movsq, .np, .none, .none, .none, .none, &.{ 0xa5 }, 0, .long  },

    .{ .movsx, .rm, .r16, .rm8,  .none, .none, &.{ 0x0f, 0xbe }, 0, .none  },
    .{ .movsx, .rm, .r16, .rm8,  .none, .none, &.{ 0x0f, 0xbe }, 0, .rex   },
    .{ .movsx, .rm, .r32, .rm8,  .none, .none, &.{ 0x0f, 0xbe }, 0, .none  },
    .{ .movsx, .rm, .r32, .rm8,  .none, .none, &.{ 0x0f, 0xbe }, 0, .rex   },
    .{ .movsx, .rm, .r64, .rm8,  .none, .none, &.{ 0x0f, 0xbe }, 0, .long  },
    .{ .movsx, .rm, .r32, .rm16, .none, .none, &.{ 0x0f, 0xbf }, 0, .none  },
    .{ .movsx, .rm, .r64, .rm16, .none, .none, &.{ 0x0f, 0xbf }, 0, .long  },

    // This instruction is discouraged.
    .{ .movsxd, .rm, .r32, .rm32, .none, .none, &.{ 0x63 }, 0, .none  },
    .{ .movsxd, .rm, .r64, .rm32, .none, .none, &.{ 0x63 }, 0, .long  },

    .{ .movzx, .rm, .r16, .rm8,  .none, .none, &.{ 0x0f, 0xb6 }, 0, .none  },
    .{ .movzx, .rm, .r32, .rm8,  .none, .none, &.{ 0x0f, 0xb6 }, 0, .none  },
    .{ .movzx, .rm, .r64, .rm8,  .none, .none, &.{ 0x0f, 0xb6 }, 0, .long  },
    .{ .movzx, .rm, .r32, .rm16, .none, .none, &.{ 0x0f, 0xb7 }, 0, .none  },
    .{ .movzx, .rm, .r64, .rm16, .none, .none, &.{ 0x0f, 0xb7 }, 0, .long  },

    .{ .mul, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 4, .none  },
    .{ .mul, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 4, .rex   },
    .{ .mul, .m, .rm16, .none, .none, .none, &.{ 0xf7 }, 4, .none  },
    .{ .mul, .m, .rm32, .none, .none, .none, &.{ 0xf7 }, 4, .none  },
    .{ .mul, .m, .rm64, .none, .none, .none, &.{ 0xf7 }, 4, .long  },

    .{ .neg, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 3, .none },
    .{ .neg, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 3, .rex  },
    .{ .neg, .m, .rm16, .none, .none, .none, &.{ 0xf7 }, 3, .none },
    .{ .neg, .m, .rm32, .none, .none, .none, &.{ 0xf7 }, 3, .none },
    .{ .neg, .m, .rm64, .none, .none, .none, &.{ 0xf7 }, 3, .long },

    .{ .nop, .np, .none, .none, .none, .none, &.{ 0x90 }, 0, .none },

    .{ .not, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 2, .none },
    .{ .not, .m, .rm8,  .none, .none, .none, &.{ 0xf6 }, 2, .rex  },
    .{ .not, .m, .rm16, .none, .none, .none, &.{ 0xf7 }, 2, .none },
    .{ .not, .m, .rm32, .none, .none, .none, &.{ 0xf7 }, 2, .none },
    .{ .not, .m, .rm64, .none, .none, .none, &.{ 0xf7 }, 2, .long },

    .{ .@"or", .zi, .al,   .imm8,   .none, .none, &.{ 0x0c }, 0, .none  },
    .{ .@"or", .zi, .ax,   .imm16,  .none, .none, &.{ 0x0d }, 0, .none  },
    .{ .@"or", .zi, .eax,  .imm32,  .none, .none, &.{ 0x0d }, 0, .none  },
    .{ .@"or", .zi, .rax,  .imm32s, .none, .none, &.{ 0x0d }, 0, .long  },
    .{ .@"or", .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 1, .none  },
    .{ .@"or", .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 1, .rex   },
    .{ .@"or", .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 1, .none  },
    .{ .@"or", .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 1, .none  },
    .{ .@"or", .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 1, .long  },
    .{ .@"or", .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 1, .none  },
    .{ .@"or", .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 1, .none  },
    .{ .@"or", .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 1, .long  },
    .{ .@"or", .mr, .rm8,  .r8,     .none, .none, &.{ 0x08 }, 0, .none  },
    .{ .@"or", .mr, .rm8,  .r8,     .none, .none, &.{ 0x08 }, 0, .rex   },
    .{ .@"or", .mr, .rm16, .r16,    .none, .none, &.{ 0x09 }, 0, .none  },
    .{ .@"or", .mr, .rm32, .r32,    .none, .none, &.{ 0x09 }, 0, .none  },
    .{ .@"or", .mr, .rm64, .r64,    .none, .none, &.{ 0x09 }, 0, .long  },
    .{ .@"or", .rm, .r8,   .rm8,    .none, .none, &.{ 0x0a }, 0, .none  },
    .{ .@"or", .rm, .r8,   .rm8,    .none, .none, &.{ 0x0a }, 0, .rex   },
    .{ .@"or", .rm, .r16,  .rm16,   .none, .none, &.{ 0x0b }, 0, .none  },
    .{ .@"or", .rm, .r32,  .rm32,   .none, .none, &.{ 0x0b }, 0, .none  },
    .{ .@"or", .rm, .r64,  .rm64,   .none, .none, &.{ 0x0b }, 0, .long  },

    .{ .pop, .o, .r16,  .none, .none, .none, &.{ 0x58 }, 0, .none  },
    .{ .pop, .o, .r64,  .none, .none, .none, &.{ 0x58 }, 0, .none  },
    .{ .pop, .m, .rm16, .none, .none, .none, &.{ 0x8f }, 0, .none  },
    .{ .pop, .m, .rm64, .none, .none, .none, &.{ 0x8f }, 0, .none  },

    .{ .popcnt, .rm, .r16, .rm16, .none, .none, &.{ 0xf3, 0x0f, 0xb8 }, 0, .none },
    .{ .popcnt, .rm, .r32, .rm32, .none, .none, &.{ 0xf3, 0x0f, 0xb8 }, 0, .none },
    .{ .popcnt, .rm, .r64, .rm64, .none, .none, &.{ 0xf3, 0x0f, 0xb8 }, 0, .long },

    .{ .push, .o, .r16,   .none, .none, .none, &.{ 0x50 }, 0, .none  },
    .{ .push, .o, .r64,   .none, .none, .none, &.{ 0x50 }, 0, .none  },
    .{ .push, .m, .rm16,  .none, .none, .none, &.{ 0xff }, 6, .none  },
    .{ .push, .m, .rm64,  .none, .none, .none, &.{ 0xff }, 6, .none  },
    .{ .push, .i, .imm8,  .none, .none, .none, &.{ 0x6a }, 0, .none  },
    .{ .push, .i, .imm16, .none, .none, .none, &.{ 0x68 }, 0, .none  },
    .{ .push, .i, .imm32, .none, .none, .none, &.{ 0x68 }, 0, .none  },

    .{ .ret, .np, .none, .none, .none, .none, &.{ 0xc3 }, 0, .none },

    .{ .rcl, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 2, .none },
    .{ .rcl, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 2, .rex  },
    .{ .rcl, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 2, .none },
    .{ .rcl, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 2, .rex  },
    .{ .rcl, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 2, .none },
    .{ .rcl, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 2, .rex  },
    .{ .rcl, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 2, .none },
    .{ .rcl, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 2, .none },
    .{ .rcl, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 2, .none },
    .{ .rcl, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 2, .none },
    .{ .rcl, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 2, .long },
    .{ .rcl, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 2, .none },
    .{ .rcl, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 2, .long },
    .{ .rcl, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 2, .none },
    .{ .rcl, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 2, .long },

    .{ .rcr, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 3, .none },
    .{ .rcr, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 3, .rex  },
    .{ .rcr, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 3, .none },
    .{ .rcr, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 3, .rex  },
    .{ .rcr, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 3, .none },
    .{ .rcr, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 3, .rex  },
    .{ .rcr, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 3, .none },
    .{ .rcr, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 3, .none },
    .{ .rcr, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 3, .none },
    .{ .rcr, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 3, .none },
    .{ .rcr, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 3, .long },
    .{ .rcr, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 3, .none },
    .{ .rcr, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 3, .long },
    .{ .rcr, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 3, .none },
    .{ .rcr, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 3, .long },

    .{ .rol, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 0, .none },
    .{ .rol, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 0, .rex  },
    .{ .rol, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 0, .none },
    .{ .rol, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 0, .rex  },
    .{ .rol, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 0, .none },
    .{ .rol, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 0, .rex  },
    .{ .rol, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 0, .none },
    .{ .rol, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 0, .none },
    .{ .rol, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 0, .none },
    .{ .rol, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 0, .none },
    .{ .rol, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 0, .long },
    .{ .rol, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 0, .none },
    .{ .rol, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 0, .long },
    .{ .rol, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 0, .none },
    .{ .rol, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 0, .long },

    .{ .ror, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 1, .none },
    .{ .ror, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 1, .rex  },
    .{ .ror, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 1, .none },
    .{ .ror, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 1, .rex  },
    .{ .ror, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 1, .none },
    .{ .ror, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 1, .rex  },
    .{ .ror, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 1, .none },
    .{ .ror, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 1, .none },
    .{ .ror, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 1, .none },
    .{ .ror, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 1, .none },
    .{ .ror, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 1, .long },
    .{ .ror, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 1, .none },
    .{ .ror, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 1, .long },
    .{ .ror, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 1, .none },
    .{ .ror, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 1, .long },

    .{ .sal, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 4, .none  },
    .{ .sal, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 4, .rex   },
    .{ .sal, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 4, .none  },
    .{ .sal, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 4, .none  },
    .{ .sal, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 4, .long  },
    .{ .sal, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 4, .none  },
    .{ .sal, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 4, .rex   },
    .{ .sal, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 4, .none  },
    .{ .sal, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 4, .none  },
    .{ .sal, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 4, .long  },
    .{ .sal, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 4, .none  },
    .{ .sal, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 4, .rex   },
    .{ .sal, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 4, .none  },
    .{ .sal, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 4, .none  },
    .{ .sal, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 4, .long  },

    .{ .sar, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 7, .none  },
    .{ .sar, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 7, .rex   },
    .{ .sar, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 7, .none  },
    .{ .sar, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 7, .none  },
    .{ .sar, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 7, .long  },
    .{ .sar, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 7, .none  },
    .{ .sar, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 7, .rex   },
    .{ .sar, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 7, .none  },
    .{ .sar, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 7, .none  },
    .{ .sar, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 7, .long  },
    .{ .sar, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 7, .none  },
    .{ .sar, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 7, .rex   },
    .{ .sar, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 7, .none  },
    .{ .sar, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 7, .none  },
    .{ .sar, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 7, .long  },

    .{ .sbb, .zi, .al,   .imm8,   .none, .none, &.{ 0x1c }, 0, .none  },
    .{ .sbb, .zi, .ax,   .imm16,  .none, .none, &.{ 0x1d }, 0, .none  },
    .{ .sbb, .zi, .eax,  .imm32,  .none, .none, &.{ 0x1d }, 0, .none  },
    .{ .sbb, .zi, .rax,  .imm32s, .none, .none, &.{ 0x1d }, 0, .long  },
    .{ .sbb, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 3, .none  },
    .{ .sbb, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 3, .rex   },
    .{ .sbb, .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 3, .none  },
    .{ .sbb, .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 3, .none  },
    .{ .sbb, .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 3, .long  },
    .{ .sbb, .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 3, .none  },
    .{ .sbb, .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 3, .none  },
    .{ .sbb, .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 3, .long  },
    .{ .sbb, .mr, .rm8,  .r8,     .none, .none, &.{ 0x18 }, 0, .none  },
    .{ .sbb, .mr, .rm8,  .r8,     .none, .none, &.{ 0x18 }, 0, .rex   },
    .{ .sbb, .mr, .rm16, .r16,    .none, .none, &.{ 0x19 }, 0, .none  },
    .{ .sbb, .mr, .rm32, .r32,    .none, .none, &.{ 0x19 }, 0, .none  },
    .{ .sbb, .mr, .rm64, .r64,    .none, .none, &.{ 0x19 }, 0, .long  },
    .{ .sbb, .rm, .r8,   .rm8,    .none, .none, &.{ 0x1a }, 0, .none  },
    .{ .sbb, .rm, .r8,   .rm8,    .none, .none, &.{ 0x1a }, 0, .rex   },
    .{ .sbb, .rm, .r16,  .rm16,   .none, .none, &.{ 0x1b }, 0, .none  },
    .{ .sbb, .rm, .r32,  .rm32,   .none, .none, &.{ 0x1b }, 0, .none  },
    .{ .sbb, .rm, .r64,  .rm64,   .none, .none, &.{ 0x1b }, 0, .long  },

    .{ .scas,  .np, .m8,   .none, .none, .none, &.{ 0xae }, 0, .none  },
    .{ .scas,  .np, .m16,  .none, .none, .none, &.{ 0xaf }, 0, .none  },
    .{ .scas,  .np, .m32,  .none, .none, .none, &.{ 0xaf }, 0, .none  },
    .{ .scas,  .np, .m64,  .none, .none, .none, &.{ 0xaf }, 0, .long  },
    .{ .scasb, .np, .none, .none, .none, .none, &.{ 0xae }, 0, .none  },
    .{ .scasw, .np, .none, .none, .none, .none, &.{ 0xaf }, 0, .short },
    .{ .scasd, .np, .none, .none, .none, .none, &.{ 0xaf }, 0, .none  },
    .{ .scasq, .np, .none, .none, .none, .none, &.{ 0xaf }, 0, .long  },

    .{ .seta,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x97 }, 0, .none },
    .{ .seta,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x97 }, 0, .rex  },
    .{ .setae,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x93 }, 0, .none },
    .{ .setae,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x93 }, 0, .rex  },
    .{ .setb,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x92 }, 0, .none },
    .{ .setb,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x92 }, 0, .rex  },
    .{ .setbe,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x96 }, 0, .none },
    .{ .setbe,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x96 }, 0, .rex  },
    .{ .setc,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x92 }, 0, .none },
    .{ .setc,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x92 }, 0, .rex  },
    .{ .sete,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x94 }, 0, .none },
    .{ .sete,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x94 }, 0, .rex  },
    .{ .setg,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9f }, 0, .none },
    .{ .setg,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9f }, 0, .rex  },
    .{ .setge,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9d }, 0, .none },
    .{ .setge,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9d }, 0, .rex  },
    .{ .setl,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9c }, 0, .none },
    .{ .setl,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9c }, 0, .rex  },
    .{ .setle,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9e }, 0, .none },
    .{ .setle,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9e }, 0, .rex  },
    .{ .setna,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x96 }, 0, .none },
    .{ .setna,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x96 }, 0, .rex  },
    .{ .setnae, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x92 }, 0, .none },
    .{ .setnae, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x92 }, 0, .rex  },
    .{ .setnb,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x93 }, 0, .none },
    .{ .setnb,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x93 }, 0, .rex  },
    .{ .setnbe, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x97 }, 0, .none },
    .{ .setnbe, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x97 }, 0, .rex  },
    .{ .setnc,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x93 }, 0, .none },
    .{ .setnc,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x93 }, 0, .rex  },
    .{ .setne,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x95 }, 0, .none },
    .{ .setne,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x95 }, 0, .rex  },
    .{ .setng,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9e }, 0, .none },
    .{ .setng,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9e }, 0, .rex  },
    .{ .setnge, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9c }, 0, .none },
    .{ .setnge, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9c }, 0, .rex  },
    .{ .setnl,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9d }, 0, .none },
    .{ .setnl,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9d }, 0, .rex  },
    .{ .setnle, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9f }, 0, .none },
    .{ .setnle, .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9f }, 0, .rex  },
    .{ .setno,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x91 }, 0, .none },
    .{ .setno,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x91 }, 0, .rex  },
    .{ .setnp,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9b }, 0, .none },
    .{ .setnp,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9b }, 0, .rex  },
    .{ .setns,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x99 }, 0, .none },
    .{ .setns,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x99 }, 0, .rex  },
    .{ .setnz,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x95 }, 0, .none },
    .{ .setnz,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x95 }, 0, .rex  },
    .{ .seto,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x90 }, 0, .none },
    .{ .seto,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x90 }, 0, .rex  },
    .{ .setp,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9a }, 0, .none },
    .{ .setp,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9a }, 0, .rex  },
    .{ .setpe,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9a }, 0, .none },
    .{ .setpe,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9a }, 0, .rex  },
    .{ .setpo,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9b }, 0, .none },
    .{ .setpo,  .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x9b }, 0, .rex  },
    .{ .sets,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x98 }, 0, .none },
    .{ .sets,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x98 }, 0, .rex  },
    .{ .setz,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x94 }, 0, .none },
    .{ .setz,   .m, .rm8, .none, .none, .none, &.{ 0x0f, 0x94 }, 0, .rex  },

    .{ .sfence, .np, .none, .none, .none, .none, &.{ 0x0f, 0xae, 0xf8 }, 0, .none },

    .{ .shl, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 4, .none  },
    .{ .shl, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 4, .rex   },
    .{ .shl, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 4, .none  },
    .{ .shl, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 4, .none  },
    .{ .shl, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 4, .long  },
    .{ .shl, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 4, .none  },
    .{ .shl, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 4, .rex   },
    .{ .shl, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 4, .none  },
    .{ .shl, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 4, .none  },
    .{ .shl, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 4, .long  },
    .{ .shl, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 4, .none  },
    .{ .shl, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 4, .rex   },
    .{ .shl, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 4, .none  },
    .{ .shl, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 4, .none  },
    .{ .shl, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 4, .long  },

    .{ .shr, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 5, .none  },
    .{ .shr, .m1, .rm8,  .unity, .none, .none, &.{ 0xd0 }, 5, .rex   },
    .{ .shr, .m1, .rm16, .unity, .none, .none, &.{ 0xd1 }, 5, .none  },
    .{ .shr, .m1, .rm32, .unity, .none, .none, &.{ 0xd1 }, 5, .none  },
    .{ .shr, .m1, .rm64, .unity, .none, .none, &.{ 0xd1 }, 5, .long  },
    .{ .shr, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 5, .none  },
    .{ .shr, .mc, .rm8,  .cl,    .none, .none, &.{ 0xd2 }, 5, .rex   },
    .{ .shr, .mc, .rm16, .cl,    .none, .none, &.{ 0xd3 }, 5, .none  },
    .{ .shr, .mc, .rm32, .cl,    .none, .none, &.{ 0xd3 }, 5, .none  },
    .{ .shr, .mc, .rm64, .cl,    .none, .none, &.{ 0xd3 }, 5, .long  },
    .{ .shr, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 5, .none  },
    .{ .shr, .mi, .rm8,  .imm8,  .none, .none, &.{ 0xc0 }, 5, .rex   },
    .{ .shr, .mi, .rm16, .imm8,  .none, .none, &.{ 0xc1 }, 5, .none  },
    .{ .shr, .mi, .rm32, .imm8,  .none, .none, &.{ 0xc1 }, 5, .none  },
    .{ .shr, .mi, .rm64, .imm8,  .none, .none, &.{ 0xc1 }, 5, .long  },

    .{ .stos,  .np, .m8,   .none, .none, .none, &.{ 0xaa }, 0, .none  },
    .{ .stos,  .np, .m16,  .none, .none, .none, &.{ 0xab }, 0, .none  },
    .{ .stos,  .np, .m32,  .none, .none, .none, &.{ 0xab }, 0, .none  },
    .{ .stos,  .np, .m64,  .none, .none, .none, &.{ 0xab }, 0, .long  },
    .{ .stosb, .np, .none, .none, .none, .none, &.{ 0xaa }, 0, .none  },
    .{ .stosw, .np, .none, .none, .none, .none, &.{ 0xab }, 0, .short },
    .{ .stosd, .np, .none, .none, .none, .none, &.{ 0xab }, 0, .none  },
    .{ .stosq, .np, .none, .none, .none, .none, &.{ 0xab }, 0, .long  },

    .{ .sub, .zi, .al,   .imm8,   .none, .none, &.{ 0x2c }, 0, .none  },
    .{ .sub, .zi, .ax,   .imm16,  .none, .none, &.{ 0x2d }, 0, .none  },
    .{ .sub, .zi, .eax,  .imm32,  .none, .none, &.{ 0x2d }, 0, .none  },
    .{ .sub, .zi, .rax,  .imm32s, .none, .none, &.{ 0x2d }, 0, .long  },
    .{ .sub, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 5, .none  },
    .{ .sub, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 5, .rex   },
    .{ .sub, .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 5, .none  },
    .{ .sub, .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 5, .none  },
    .{ .sub, .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 5, .long  },
    .{ .sub, .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 5, .none  },
    .{ .sub, .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 5, .none  },
    .{ .sub, .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 5, .long  },
    .{ .sub, .mr, .rm8,  .r8,     .none, .none, &.{ 0x28 }, 0, .none  },
    .{ .sub, .mr, .rm8,  .r8,     .none, .none, &.{ 0x28 }, 0, .rex   },
    .{ .sub, .mr, .rm16, .r16,    .none, .none, &.{ 0x29 }, 0, .none  },
    .{ .sub, .mr, .rm32, .r32,    .none, .none, &.{ 0x29 }, 0, .none  },
    .{ .sub, .mr, .rm64, .r64,    .none, .none, &.{ 0x29 }, 0, .long  },
    .{ .sub, .rm, .r8,   .rm8,    .none, .none, &.{ 0x2a }, 0, .none  },
    .{ .sub, .rm, .r8,   .rm8,    .none, .none, &.{ 0x2a }, 0, .rex   },
    .{ .sub, .rm, .r16,  .rm16,   .none, .none, &.{ 0x2b }, 0, .none  },
    .{ .sub, .rm, .r32,  .rm32,   .none, .none, &.{ 0x2b }, 0, .none  },
    .{ .sub, .rm, .r64,  .rm64,   .none, .none, &.{ 0x2b }, 0, .long  },

    .{ .syscall, .np, .none, .none, .none, .none, &.{ 0x0f, 0x05 }, 0, .none }
,
    .{ .@"test", .zi, .al,   .imm8,   .none, .none, &.{ 0xa8 }, 0, .none  },
    .{ .@"test", .zi, .ax,   .imm16,  .none, .none, &.{ 0xa9 }, 0, .none  },
    .{ .@"test", .zi, .eax,  .imm32,  .none, .none, &.{ 0xa9 }, 0, .none  },
    .{ .@"test", .zi, .rax,  .imm32s, .none, .none, &.{ 0xa9 }, 0, .long  },
    .{ .@"test", .mi, .rm8,  .imm8,   .none, .none, &.{ 0xf6 }, 0, .none  },
    .{ .@"test", .mi, .rm8,  .imm8,   .none, .none, &.{ 0xf6 }, 0, .rex   },
    .{ .@"test", .mi, .rm16, .imm16,  .none, .none, &.{ 0xf7 }, 0, .none  },
    .{ .@"test", .mi, .rm32, .imm32,  .none, .none, &.{ 0xf7 }, 0, .none  },
    .{ .@"test", .mi, .rm64, .imm32s, .none, .none, &.{ 0xf7 }, 0, .long  },
    .{ .@"test", .mr, .rm8,  .r8,     .none, .none, &.{ 0x84 }, 0, .none  },
    .{ .@"test", .mr, .rm8,  .r8,     .none, .none, &.{ 0x84 }, 0, .rex   },
    .{ .@"test", .mr, .rm16, .r16,    .none, .none, &.{ 0x85 }, 0, .none  },
    .{ .@"test", .mr, .rm32, .r32,    .none, .none, &.{ 0x85 }, 0, .none  },
    .{ .@"test", .mr, .rm64, .r64,    .none, .none, &.{ 0x85 }, 0, .long  },

    .{ .tzcnt, .rm, .r16, .rm16, .none, .none, &.{ 0xf3, 0x0f, 0xbc }, 0, .none },
    .{ .tzcnt, .rm, .r32, .rm32, .none, .none, &.{ 0xf3, 0x0f, 0xbc }, 0, .none },
    .{ .tzcnt, .rm, .r64, .rm64, .none, .none, &.{ 0xf3, 0x0f, 0xbc }, 0, .long },

    .{ .ud2, .np, .none, .none, .none, .none, &.{ 0x0f, 0x0b }, 0, .none  },

    .{ .xadd, .mr, .rm8,  .r8,  .none, .none, &.{ 0x0f, 0xc0 }, 0, .none  },
    .{ .xadd, .mr, .rm8,  .r8,  .none, .none, &.{ 0x0f, 0xc0 }, 0, .rex   },
    .{ .xadd, .mr, .rm16, .r16, .none, .none, &.{ 0x0f, 0xc1 }, 0, .none  },
    .{ .xadd, .mr, .rm32, .r32, .none, .none, &.{ 0x0f, 0xc1 }, 0, .none  },
    .{ .xadd, .mr, .rm64, .r64, .none, .none, &.{ 0x0f, 0xc1 }, 0, .long  },

    .{ .xchg, .o,  .ax,   .r16,  .none, .none, &.{ 0x90 }, 0, .none },
    .{ .xchg, .o,  .r16,  .ax,   .none, .none, &.{ 0x90 }, 0, .none },
    .{ .xchg, .o,  .eax,  .r32,  .none, .none, &.{ 0x90 }, 0, .none },
    .{ .xchg, .o,  .rax,  .r64,  .none, .none, &.{ 0x90 }, 0, .long },
    .{ .xchg, .o,  .r32,  .eax,  .none, .none, &.{ 0x90 }, 0, .none },
    .{ .xchg, .o,  .r64,  .rax,  .none, .none, &.{ 0x90 }, 0, .long },
    .{ .xchg, .mr, .rm8,  .r8,   .none, .none, &.{ 0x86 }, 0, .none },
    .{ .xchg, .mr, .rm8,  .r8,   .none, .none, &.{ 0x86 }, 0, .rex  },
    .{ .xchg, .rm, .r8,   .rm8,  .none, .none, &.{ 0x86 }, 0, .none },
    .{ .xchg, .rm, .r8,   .rm8,  .none, .none, &.{ 0x86 }, 0, .rex  },
    .{ .xchg, .mr, .rm16, .r16,  .none, .none, &.{ 0x87 }, 0, .none },
    .{ .xchg, .rm, .r16,  .rm16, .none, .none, &.{ 0x87 }, 0, .none },
    .{ .xchg, .mr, .rm32, .r32,  .none, .none, &.{ 0x87 }, 0, .none },
    .{ .xchg, .mr, .rm64, .r64,  .none, .none, &.{ 0x87 }, 0, .long },
    .{ .xchg, .rm, .r32,  .rm32, .none, .none, &.{ 0x87 }, 0, .none },
    .{ .xchg, .rm, .r64,  .rm64, .none, .none, &.{ 0x87 }, 0, .long },

    .{ .xor, .zi, .al,   .imm8,   .none, .none, &.{ 0x34 }, 0, .none  },
    .{ .xor, .zi, .ax,   .imm16,  .none, .none, &.{ 0x35 }, 0, .none  },
    .{ .xor, .zi, .eax,  .imm32,  .none, .none, &.{ 0x35 }, 0, .none  },
    .{ .xor, .zi, .rax,  .imm32s, .none, .none, &.{ 0x35 }, 0, .long  },
    .{ .xor, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 6, .none  },
    .{ .xor, .mi, .rm8,  .imm8,   .none, .none, &.{ 0x80 }, 6, .rex   },
    .{ .xor, .mi, .rm16, .imm16,  .none, .none, &.{ 0x81 }, 6, .none  },
    .{ .xor, .mi, .rm32, .imm32,  .none, .none, &.{ 0x81 }, 6, .none  },
    .{ .xor, .mi, .rm64, .imm32s, .none, .none, &.{ 0x81 }, 6, .long  },
    .{ .xor, .mi, .rm16, .imm8s,  .none, .none, &.{ 0x83 }, 6, .none  },
    .{ .xor, .mi, .rm32, .imm8s,  .none, .none, &.{ 0x83 }, 6, .none  },
    .{ .xor, .mi, .rm64, .imm8s,  .none, .none, &.{ 0x83 }, 6, .long  },
    .{ .xor, .mr, .rm8,  .r8,     .none, .none, &.{ 0x30 }, 0, .none  },
    .{ .xor, .mr, .rm8,  .r8,     .none, .none, &.{ 0x30 }, 0, .rex   },
    .{ .xor, .mr, .rm16, .r16,    .none, .none, &.{ 0x31 }, 0, .none  },
    .{ .xor, .mr, .rm32, .r32,    .none, .none, &.{ 0x31 }, 0, .none  },
    .{ .xor, .mr, .rm64, .r64,    .none, .none, &.{ 0x31 }, 0, .long  },
    .{ .xor, .rm, .r8,   .rm8,    .none, .none, &.{ 0x32 }, 0, .none  },
    .{ .xor, .rm, .r8,   .rm8,    .none, .none, &.{ 0x32 }, 0, .rex   },
    .{ .xor, .rm, .r16,  .rm16,   .none, .none, &.{ 0x33 }, 0, .none  },
    .{ .xor, .rm, .r32,  .rm32,   .none, .none, &.{ 0x33 }, 0, .none  },
    .{ .xor, .rm, .r64,  .rm64,   .none, .none, &.{ 0x33 }, 0, .long  },

    // SSE
    .{ .addss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x58 }, 0, .sse },

    .{ .cmpss, .rmi, .xmm, .xmm_m32, .imm8, .none, &.{ 0xf3, 0x0f, 0xc2 }, 0, .sse },

    .{ .divss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x5e }, 0, .sse },

    .{ .maxss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x5f }, 0, .sse },

    .{ .minss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x5d }, 0, .sse },

    .{ .movss, .rm, .xmm,     .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x10 }, 0, .sse },
    .{ .movss, .mr, .xmm_m32, .xmm,     .none, .none, &.{ 0xf3, 0x0f, 0x11 }, 0, .sse },

    .{ .mulss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x59 }, 0, .sse },

    .{ .subss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0xf3, 0x0f, 0x5c }, 0, .sse },

    .{ .ucomiss, .rm, .xmm, .xmm_m32, .none, .none, &.{ 0x0f, 0x2e }, 0, .sse },

    // SSE2
    .{ .addsd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x58 }, 0, .sse2 },

    .{ .cmpsd, .rmi, .xmm, .xmm_m64, .imm8, .none, &.{ 0xf2, 0x0f, 0xc2 }, 0, .sse2 },

    .{ .divsd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x5e }, 0, .sse2 },

    .{ .maxsd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x5f }, 0, .sse2 },

    .{ .minsd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x5d }, 0, .sse2 },

    .{ .movq, .rm, .xmm,     .xmm_m64, .none, .none, &.{ 0xf3, 0x0f, 0x7e }, 0, .sse2 },
    .{ .movq, .mr, .xmm_m64, .xmm,     .none, .none, &.{ 0x66, 0x0f, 0xd6 }, 0, .sse2 },

    .{ .mulsd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x59 }, 0, .sse2 },

    .{ .subsd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x5c }, 0, .sse2 },

    .{ .movsd, .rm, .xmm,     .xmm_m64, .none, .none, &.{ 0xf2, 0x0f, 0x10 }, 0, .sse2 },
    .{ .movsd, .mr, .xmm_m64, .xmm,     .none, .none, &.{ 0xf2, 0x0f, 0x11 }, 0, .sse2 },

    .{ .ucomisd, .rm, .xmm, .xmm_m64, .none, .none, &.{ 0x66, 0x0f, 0x2e }, 0, .sse2 },

    // SSE4.1
    .{ .roundss, .rmi, .xmm, .xmm_m32, .imm8, .none, &.{ 0x66, 0x0f, 0x3a, 0x0a }, 0, .sse4_1 },
    .{ .roundsd, .rmi, .xmm, .xmm_m64, .imm8, .none, &.{ 0x66, 0x0f, 0x3a, 0x0b }, 0, .sse4_1 },
};
// zig fmt: on
